---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# BOLDconnectR

<!-- badges: start -->
<!-- badges: end -->

BOLDconnectR is a package designed for retrieval, transformation and analysis of the data available in the Barcode Of Life Data Systems (BOLD) database. This package provides the functionality to obtain public as well as private user data available in the database.

## Installation

You can install the development version of BOLDconnectR from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("sameerpadhye/BOLDconnectR")
```

## Note on API key

API key can be obtained by emailing the BOLD support (support@boldsystems.org).
API key is needed only for the data retrieval and can be added directly within the function. Alternatively, it can be set up as an environmental variable using the 'Sys.setenv' function. 

```{r}

Sys.setenv ("api_key"="api.key")

```

It can then be retrieved using ‘Sys.getenv’ function directly or by storing it as another variable.

```{r}

api.key <- Sys.getenv('api_key')
api.key
```

# Test data

Test data is a data frame having 2 columns and 2205 rows. First column has 'processids' while second has 'sampleids'.

```{r}

data("test.data")

head(test.data)

```

# Function usage


## bold.connectr.public


### default (all data retrieved)
The arguments provided below need to be specified by default for every request

```{r bold.fetch.data}

library(BOLDconnectR)

data("test.data")

api.key <- Sys.getenv('api_key')

result<-bold.fetch.data(input.data = test.data,
                                  param = 'processid',
                                  param.index = 1,
                                  api_key = api.key)

# Output showing the first 5 rows

knitr::kable(head(result,5))

```


## bold.connectr


### default (all data retrieved)
The arguments provided below need to be specified by default for every request

```{r bold.fetch.data}

library(BOLDconnectR)

data("test.data")

api.key <- Sys.getenv('api_key')

result<-bold.connectr(input.data = test.data,
                                  param = 'processid',
                                  param.index = 1,
                                  api_key = api.key)
# Output showing the first 5 rows

knitr::kable(head(result,5))

```

### using some filters

```{r bold.fetch.data2}

library(BOLDconnectR)

data("test.data")

api.key <- Sys.getenv('api_key')

result2<-bold.fetch.data(data.file = test.data,
                                  id = 'processid',
                                  id.col.index = 1,
                                  api_key = api.key,
                         taxanomy = c("Milvus migrans","Achatina fulica","Faxonius virilis"),
                         fields = c("bin_uri","order","family","genus","species"))

# Output showing the first 10 columns

knitr::kable(head(result2,5))

```

## bold.data.profile

Result of the `bold.fetch.data` needs to be provided here

```{r bold.data.profile}

data.profile<-bold.data.profile(result,
                                columns = c("species","collectors","marker_code","identified_by","nuc_basecount"),
                                col.name.info = F)


data.profile

```


## bold.seq.data

The output of the `bold.fetch.data` needs to be provided here

```{r bold.seq.data}

seq_result<-bold.seq.data(result,
                       marker = "COI-5P",
                       type = "ape")


# Sequence data

seq_result$sequences


# ids having no sequence data

head(seq_result$no.seq.ids,5)

```

